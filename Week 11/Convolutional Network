https://www.cs.ryerson.ca/~aharley/vis/conv/flat.html